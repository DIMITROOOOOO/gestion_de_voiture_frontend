<div class="container mt-4">
  <h2 class="mb-4 text-center">Gestion des Chauffeurs</h2>

  <button class="btn btn-primary mb-3" (click)="openModal('addChauffeurModal')">
    <i class="fas fa-plus"></i> Ajouter un Chauffeur
  </button>

  <div class="card mb-4 shadow">
    <div class="card-header bg-primary text-white">
      <h3 class="card-title">Liste des Chauffeurs</h3>
    </div>
    <div class="card-body">
      <table class="table table-striped table-hover">
        <thead class="thead-dark">
          <tr>
            <th>ID</th>
            <th>Nom</th>
            <th>Téléphone</th>
            <th>Numéro de Permis</th>
            <th>Date d'Embauche</th>
            <th>Statut</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let chauffeur of chauffeurs">
            <td>{{ chauffeur.chauffeur_id }}</td>
            <td>{{ chauffeur.nom }}</td>
            <td>{{ chauffeur.telephone }}</td>
            <td>{{ chauffeur.numero_permis }}</td>
            <td>{{ chauffeur.date_embauche | date: 'dd/MM/yyyy' }}</td>
            <td>{{ chauffeur.statutChaffeurs }}</td>
            <td>
              <button class="btn btn-warning btn-sm me-2" (click)="openEditModal(chauffeur)">
                <i class="fas fa-edit"></i> Modifier
              </button>
              <button class="btn btn-danger btn-sm" (click)="openDeleteModal(chauffeur)">
                <i class="fas fa-trash"></i> Supprimer
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>


<div *ngIf="showAddChauffeurModal" class="modal fade show" tabindex="-1" style="display: block;">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header bg-primary text-white">
        <h5 class="modal-title">Ajouter un Chauffeur</h5>
        <button type="button" class="btn-close" (click)="closeModal('addChauffeurModal')"></button>
      </div>
      <div class="modal-body">
        <form (ngSubmit)="addChauffeur()">
          <div class="mb-3">
            <label for="nom" class="form-label">Nom:</label>
            <input id="nom" class="form-control" [(ngModel)]="currentChauffeur.nom" name="nom" required />
          </div>
          <div class="mb-3">
            <label for="telephone" class="form-label">Téléphone:</label>
            <input id="telephone" class="form-control" [(ngModel)]="currentChauffeur.telephone" name="telephone" required />
          </div>
          <div class="mb-3">
            <label for="numero_permis" class="form-label">Numéro de Permis:</label>
            <input id="numero_permis" class="form-control" [(ngModel)]="currentChauffeur.numero_permis" name="numero_permis" required />
          </div>
          <div class="mb-3">
            <label for="date_embauche" class="form-label">Date d'Embauche:</label>
            <input id="date_embauche" type="date" class="form-control" [(ngModel)]="currentChauffeur.date_embauche" name="date_embauche" required />
          </div>
          <div class="mb-3">
            <label for="statutChaffeurs" class="form-label">Statut:</label>
            <select id="statutChaffeurs" class="form-select" [(ngModel)]="currentChauffeur.statutChaffeurs" name="statutChaffeurs" required>
              <option *ngFor="let status of getDriverStatutValues()" [value]="status">{{ status }}</option>
            </select>
          </div>
          <div class="text-end">
            <button type="submit" class="btn btn-primary">
              <i class="fas fa-save"></i> Ajouter
            </button>
            <button type="button" class="btn btn-secondary ms-2" (click)="closeModal('addChauffeurModal')">
              <i class="fas fa-times"></i> Annuler
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<div *ngIf="showEditChauffeurModal" class="modal fade show" tabindex="-1" style="display: block;">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header bg-warning text-white">
        <h5 class="modal-title">Modifier le Chauffeur</h5>
        <button type="button" class="btn-close" (click)="closeModal('editChauffeurModal')"></button>
      </div>
      <div class="modal-body">
        <form (ngSubmit)="updateChauffeur()">
          <div class="mb-3">
            <label for="editNom" class="form-label">Nom:</label>
            <input id="editNom" class="form-control" [(ngModel)]="currentChauffeur.nom" name="nom" required />
          </div>
          <div class="mb-3">
            <label for="editTelephone" class="form-label">Téléphone:</label>
            <input id="editTelephone" class="form-control" [(ngModel)]="currentChauffeur.telephone" name="telephone" required />
          </div>
          <div class="mb-3">
            <label for="editNumeroPermis" class="form-label">Numéro de Permis:</label>
            <input id="editNumeroPermis" class="form-control" [(ngModel)]="currentChauffeur.numero_permis" name="numero_permis" required />
          </div>
          <div class="mb-3">
            <label for="editDateEmbauche" class="form-label">Date d'Embauche:</label>
            <input id="editDateEmbauche" type="date" class="form-control" [(ngModel)]="currentChauffeur.date_embauche" name="date_embauche" required />
          </div>
          <div class="mb-3">
            <label for="editStatutChaffeurs" class="form-label">Statut:</label>
            <select id="editStatutChaffeurs" class="form-select" [(ngModel)]="currentChauffeur.statutChaffeurs" name="statutChaffeurs" required>
              <option *ngFor="let status of getDriverStatutValues()" [value]="status">{{ status }}</option>
            </select>
          </div>
          <div class="text-end">
            <button type="submit" class="btn btn-warning">
              <i class="fas fa-save"></i> Mettre à Jour
            </button>
            <button type="button" class="btn btn-secondary ms-2" (click)="closeModal('editChauffeurModal')">
              <i class="fas fa-times"></i> Annuler
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<div *ngIf="showDeleteChauffeurModal" class="modal fade show" tabindex="-1" style="display: block;">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header bg-danger text-white">
        <h5 class="modal-title">Supprimer le Chauffeur</h5>
        <button type="button" class="btn-close" (click)="closeModal('deleteChauffeurModal')"></button>
      </div>
      <div class="modal-body">
        <p>Êtes-vous sûr de vouloir supprimer ce chauffeur ?</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" (click)="closeModal('deleteChauffeurModal')">
          <i class="fas fa-times"></i> Annuler
        </button>
        <button type="button" class="btn btn-danger" (click)="deleteChauffeur(currentChauffeur.chauffeur_id)">
          <i class="fas fa-trash"></i> Supprimer
        </button>
      </div>
    </div>
  </div>
</div>